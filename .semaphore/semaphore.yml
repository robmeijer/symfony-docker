# For more PHP information and examples, see
# https://docs.semaphoreci.com/article/84-language-php
version: v1.0
name: CI
agent:
  machine:
    type: e1-standard-2
    os_image: ubuntu1804
blocks:
  - name: "Install dependencies"
    task:
      jobs:
        - name: "Composer"
          commands:
            - checkout
            - phpbrew ext install iconv
            - cache restore
            - composer install --no-interaction --classmap-authoritative
            - cache store
promotions:
    - name: "Dockerize"
      pipeline_file: docker-build.yml
      auto_promote_on:
          - result: passed
